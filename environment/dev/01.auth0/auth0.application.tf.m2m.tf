# =============================================================================
# terraform_integration_templates :: environment/dev/auth0/auth0.application.tf.m2m.tf
#      :: mdunbar :: 2025 oct 05 :: MIT License Â© 2025 Matthew Dunbar ::
# =============================================================================
resource "auth0_client" "terraform_access" {
  name      = "Terraform Access"
  app_type  = "non_interactive"  # machine-to-machine
  description = "Dedicated client for Terraform to manage Auth0 programmatically"

  # Optional: JSON web token signing / encryption settings
  # Only needed if Terraform uses JWT-based auth for API calls
  is_first_party = true
  oidc_conformant = true

  # Scopes for Management API
  grant_types = ["client_credentials"]
}

resource "auth0_client_grant" "terraform_m2m_grant" {
  client_id = auth0_client.terraform_access.client_id
  audience  = "https://${var.auth0_domain}/api/v2/"
  scopes    = [
      "blacklist:tokens",
      "create:actions",
      "create:authentication_methods",
      "create:client_credentials",
      "create:client_grants",
      "create:client_keys",
      "create:clients",
      "create:connection_profiles",
      "create:connections",
      "create:connections_keys",
      "create:custom_domains",
      "create:custom_signing_keys",
      "create:device_credentials",
      "create:email_provider",
      "create:email_templates",
      "create:encryption_keys",
      "create:event_streams",
      "create:flows",
      "create:flows_vault_connections",
      "create:forms",
      "create:guardian_enrollment_tickets",
      "create:hooks",
      "create:log_streams",
      "create:network_acls",
      "create:organization_client_grants",
      "create:organization_connections",
      "create:organization_discovery_domains",
      "create:organization_invitations",
      "create:organization_member_roles",
      "create:organization_members",
      "create:organizations",
      "create:passwords_checking_job",
      "create:phone_providers",
      "create:phone_templates",
      "create:resource_servers",
      "create:role_members",
      "create:roles",
      "create:rules",
      "create:scim_config",
      "create:scim_token",
      "create:self_service_profiles",
      "create:shields",
      "create:signing_keys",
      "create:sso_access_tickets",
      "create:user_attribute_profiles",
      "create:user_custom_blocks",
      "create:user_tickets",
      "create:users",
      "create:users_app_metadata",
      "create:vdcs_templates",
      "delete:actions",
      "delete:anomaly_blocks",
      "delete:authentication_methods",
      "delete:branding",
      "delete:client_credentials",
      "delete:client_grants",
      "delete:client_keys",
      "delete:clients",
      "delete:connection_profiles",
      "delete:connections",
      "delete:custom_domains",
      "delete:custom_signing_keys",
      "delete:device_credentials",
      "delete:email_provider",
      "delete:encryption_keys",
      "delete:event_streams",
      "delete:federated_connections_tokens",
      "delete:flows",
      "delete:flows_executions",
      "delete:flows_vault_connections",
      "delete:forms",
      "delete:grants",
      "delete:guardian_enrollments",
      "delete:hooks",
      "delete:log_streams",
      "delete:network_acls",
      "delete:organization_client_grants",
      "delete:organization_connections",
      "delete:organization_discovery_domains",
      "delete:organization_invitations",
      "delete:organization_member_roles",
      "delete:organization_members",
      "delete:organizations",
      "delete:passwords_checking_job",
      "delete:phone_providers",
      "delete:phone_templates",
      "delete:refresh_tokens",
      "delete:resource_servers",
      "delete:role_members",
      "delete:roles",
      "delete:rules",
      "delete:rules_configs",
      "delete:scim_config",
      "delete:scim_token",
      "delete:self_service_profiles",
      "delete:sessions",
      "delete:shields",
      "delete:sso_access_tickets",
      "delete:user_attribute_profiles",
      "delete:user_custom_blocks",
      "delete:users",
      "delete:users_app_metadata",
      "delete:vdcs_templates",
      "read:actions",
      "read:anomaly_blocks",
      "read:attack_protection",
      "read:authentication_methods",
      "read:branding",
      "read:client_credentials",
      "read:client_grants",
      "read:client_keys",
      "read:clients",
      "read:connection_profiles",
      "read:connections",
      "read:connections_keys",
      "read:connections_options",
      "read:custom_domains",
      "read:custom_signing_keys",
      "read:device_credentials",
      "read:email_provider",
      "read:email_templates",
      "read:encryption_keys",
      "read:entitlements",
      "read:event_deliveries",
      "read:event_streams",
      "read:federated_connections_tokens",
      "read:flows",
      "read:flows_executions",
      "read:flows_vault",
      "read:flows_vault_connections",
      "read:forms",
      "read:grants",
      "read:guardian_enrollments",
      "read:guardian_factors",
      "read:hooks",
      "read:insights",
      "read:limits",
      "read:log_streams",
      "read:logs",
      "read:logs_users",
      "read:mfa_policies",
      "read:network_acls",
      "read:organization_client_grants",
      "read:organization_connections",
      "read:organization_discovery_domains",
      "read:organization_invitations",
      "read:organization_member_roles",
      "read:organization_members",
      "read:organizations",
      "read:organizations_summary",
      "read:phone_providers",
      "read:phone_templates",
      "read:prompts",
      "read:refresh_tokens",
      "read:resource_servers",
      "read:role_members",
      "read:roles",
      "read:rules",
      "read:rules_configs",
      "read:scim_config",
      "read:scim_token",
      "read:security_metrics",
      "read:self_service_profile_custom_texts",
      "read:self_service_profiles",
      "read:sessions",
      "read:shields",
      "read:signing_keys",
      "read:stats",
      "read:tenant_settings",
      "read:triggers",
      "read:user_attribute_profiles",
      "read:user_custom_blocks",
      "read:user_idp_tokens",
      "read:users",
      "read:users_app_metadata",
      "read:vdcs_templates",
      "update:actions",
      "update:attack_protection",
      "update:authentication_methods",
      "update:branding",
      "update:client_credentials",
      "update:client_grants",
      "update:client_keys",
      "update:clients",
      "update:connection_profiles",
      "update:connections",
      "update:connections_keys",
      "update:connections_options",
      "update:custom_domains",
      "update:custom_signing_keys",
      "update:device_credentials",
      "update:email_provider",
      "update:email_templates",
      "update:encryption_keys",
      "update:event_deliveries",
      "update:event_streams",
      "update:flows",
      "update:flows_vault_connections",
      "update:forms",
      "update:guardian_factors",
      "update:hooks",
      "update:limits",
      "update:log_streams",
      "update:mfa_policies",
      "update:network_acls",
      "update:organization_connections",
      "update:organization_discovery_domains",
      "update:organizations",
      "update:phone_providers",
      "update:phone_templates",
      "update:prompts",
      "update:resource_servers",
      "update:roles",
      "update:rules",
      "update:rules_configs",
      "update:scim_config",
      "update:self_service_profile_custom_texts",
      "update:self_service_profiles",
      "update:sessions",
      "update:shields",
      "update:signing_keys",
      "update:tenant_settings",
      "update:triggers",
      "update:user_attribute_profiles",
      "update:users",
      "update:users_app_metadata",
      "update:vdcs_templates",
  ]
}

# =============================================================================
